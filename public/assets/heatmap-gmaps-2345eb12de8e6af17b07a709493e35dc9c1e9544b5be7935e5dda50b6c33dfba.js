function HeatmapOverlay(t,e){this.heatmap=null,this.conf=e,this.latlngs=[],this.setMap(t)}HeatmapOverlay.prototype=new google.maps.OverlayView,HeatmapOverlay.prototype.onAdd=function(){var t=this.getPanes(),e=this.getMap().getDiv().clientWidth,a=this.getMap().getDiv().clientHeight,o=document.createElement("div");o.style.position="absolute",o.style.top=0,o.style.left=0,o.style.width=e+"px",o.style.height=a+"px",o.style.border=0,this.conf.element=o,t.overlayLayer.appendChild(o),this.heatmap=h337.create(this.conf)},HeatmapOverlay.prototype.onRemove=function(){},HeatmapOverlay.prototype.draw=function(){var t=this.getProjection(),e=this.map.getBounds(),a=t.fromLatLngToDivPixel(e.getNorthEast()),o=t.fromLatLngToDivPixel(e.getSouthWest()),i=a.y,n=o.x;if(this.conf.element.style.left=n,this.conf.element.style.top=i,this.latlngs.length>0){this.heatmap.clear();for(var s=this.latlngs.length,l=this.getProjection(),r={max:this.heatmap.store.max,data:[]};s--;){var h=this.latlngs[s].latlng;if(e.contains(h)){var p=l.fromLatLngToDivPixel(h),g=new google.maps.Point(p.x-n,p.y-i),m=this.pixelTransform(g);r.data.push({x:m.x,y:m.y,count:this.latlngs[s].c})}}this.heatmap.store.setDataSet(r)}},HeatmapOverlay.prototype.pixelTransform=function(t){for(var e=this.heatmap.get("width"),a=this.heatmap.get("height");t.x<0;)t.x+=e;for(;t.x>e;)t.x-=e;for(;t.y<0;)t.y+=a;for(;t.y>a;)t.y-=a;return t.x=~~(t.x+.5),t.y=~~(t.y+.5),t},HeatmapOverlay.prototype.setDataSet=function(t){for(var e={max:t.max,data:[]},a=t.data,o=a.length,i=this.getProjection();o--;){var n=new google.maps.LatLng(a[o].lat,a[o].lng);this.latlngs.push({latlng:n,c:a[o].count});var s=this.pixelTransform(i.fromLatLngToDivPixel(n));e.data.push({x:s.x,y:s.y,count:a[o].count})}this.heatmap.clear(),this.heatmap.store.setDataSet(e)},HeatmapOverlay.prototype.addDataPoint=function(t,e,a){var o=this.getProjection(),i=new google.maps.LatLng(t,e),n=this.pixelTransform(o.fromLatLngToDivPixel(i));this.heatmap.store.addDataPoint(n.x,n.y,a),this.latlngs.push({latlng:i,c:a})},HeatmapOverlay.prototype.toggle=function(){this.heatmap.toggleDisplay()},HeatmapOverlay.prototype.destroy=function(){this.heatmap.clear()};